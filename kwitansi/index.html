<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rumah Nenek Laundry</title>
<style>
body{font-family:sans-serif;padding:20px;background:#f7f7f7;}
h2{text-align:center;color:#333;}
form{background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
input,select,textarea,button{width:100%;margin:5px 0;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;}
button{background:#4CAF50;color:#fff;border:none;cursor:pointer;}
button:hover{background:#45a049;}
#status{margin-top:10px;color:#333;text-align:center;}
#kwitansiDisplay{background:#fff;padding:10px;margin-top:10px;border-radius:5px;white-space:pre-line;font-family:monospace;}
@media print {
  body{font-size:14px;margin:0;}
  form, #status, #waBtn, #copyBtn{display:none;}
}
</style>
</head>
<body>

<h2>Input Kwitansi Laundry</h2>

<form id="kwitansiForm">
  <input type="text" id="nama" placeholder="Nama Konsumen" required>
  <input type="text" id="alamat" placeholder="Alamat Konsumen" required>
  <input type="text" id="no_wa" placeholder="No WA" required>
  <select id="jenis">
    <option value="Cuci Kiloan">Cuci Kiloan</option>
    <option value="Cuci Satuan">Cuci Satuan</option>
  </select>
  <textarea id="catatan" placeholder="Catatan"></textarea>
  <input type="number" id="total" placeholder="Total Harga" required>
  <select id="metode">
    <option value="Cash">Cash</option>
    <option value="Transfer">Transfer</option>
  </select>
  <button type="submit">Kirim Kwitansi</button>
</form>

<div id="status"></div>

<div style="margin-top:10px;text-align:center;">
  <button id="printBtn">Print Kwitansi</button>
  <button id="waBtn">Share WA</button>
  <button id="copyBtn">Copy Kwitansi</button>
</div>

<div id="kwitansiDisplay"></div>

<script>
// Ganti URL ini dengan Web App URL final kamu
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxYI1iBRJTbHdPFUhcIg4BtGaCxAZnfzErX3hS0gThC4lH12lL1v8jsywK2axb_noybBA/exec';

const form = document.getElementById('kwitansiForm');
const display = document.getElementById('kwitansiDisplay');
const status = document.getElementById('status');

form.addEventListener('submit', function(e){
  e.preventDefault();
  const data = {
    Nama_Konsumen: document.getElementById('nama').value || '',
    Alamat: document.getElementById('alamat').value || '',
    No_WA: document.getElementById('no_wa').value || '0',
    Jenis_Layanan: document.getElementById('jenis').value || 'Cuci Kiloan',
    Catatan: document.getElementById('catatan').value || '',
    Total_Harga: Number(document.getElementById('total').value || 0),
    Metode_Pembayaran: document.getElementById('metode').value || 'Cash'
  };

  // Tampilkan kwitansi di page
  const kwitansiText = `Kwitansi Laundry\nNama: ${data.Nama_Konsumen}\nAlamat: ${data.Alamat}\nWA: ${data.No_WA}\nJenis: ${data.Jenis_Layanan}\nCatatan: ${data.Catatan}\nTotal: Rp ${data.Total_Harga}\nMetode: ${data.Metode_Pembayaran}`;
  display.textContent = kwitansiText;

  // Kirim ke Web App via fetch
  fetch(WEB_APP_URL, {
    method: 'POST',
    body: JSON.stringify(data),
    headers: {'Content-Type':'application/json'}
  })
  .then(res=>res.json())
  .then(res=>{
    if(res.ok){
      status.innerText = 'Kwitansi berhasil dikirim ke GSheet';
      form.reset();
    } else {
      status.innerText = 'Gagal: '+res.error;
    }
  })
  .catch(err=>{
    status.innerText = 'Error: '+err;
  });
});

// Print
document.getElementById('printBtn').addEventListener('click', function(){
  if(display.textContent){
    window.print();
  } else {
    alert('Tidak ada kwitansi untuk dicetak!');
  }
});

// Share WA
document.getElementById('waBtn').addEventListener('click', function(){
  let noWa = document.getElementById('no_wa').value || '0';
  if(noWa.startsWith('0')) noWa = '62'+noWa.slice(1);
  const nama = document.getElementById('nama').value || '';
  const total = document.getElementById('total').value || '0';
  const msg = `Kwitansi Laundry:\nNama: ${nama}\nTotal: Rp ${total}`;
  const waUrl = `https://wa.me/${noWa}?text=${encodeURIComponent(msg)}`;
  window.open(waUrl,'_blank');
});

// Copy to clipboard
document.getElementById('copyBtn').addEventListener('click', function(){
  const text = display.textContent;
  if(text){
    navigator.clipboard.writeText(text).then(()=>{
      alert('Kwitansi berhasil dicopy ke clipboard!');
    }).catch(err=>{
      alert('Gagal copy kwitansi: '+err);
    });
  } else {
    alert('Tidak ada kwitansi untuk dicopy!');
  }
});
</script>

</body>
</html>