<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rumah Nenek Laundry</title>
<style>
body{font-family:sans-serif;padding:20px;background:#f7f7f7;}
h2{text-align:center;color:#333;}
form{background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
input,select,textarea,button{width:100%;margin:5px 0;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;}
button{background:#4CAF50;color:#fff;border:none;cursor:pointer;}
button:hover{background:#45a049;}
#status{margin-top:10px;color:#333;text-align:center;}
#kwitansiDisplay{background:#fff;padding:10px;margin-top:10px;border-radius:5px;white-space:pre-line;font-family:monospace;}
@media print {
  body{font-size:14px;margin:0;}
  form, #status, #waBtn, #copyBtn{display:none;}
}
</style>
</head>
<body>

<h2>Input Kwitansi Laundry</h2>

<form action="https://script.google.com/macros/s/AKfycbxYI1iBRJTbHdPFUhcIg4BtGaCxAZnfzErX3hS0gThC4lH12lL1v8jsywK2axb_noybBA/exec" method="post">
  <input type="text" name="Nama_Konsumen" placeholder="Nama Konsumen" required>
  <input type="text" name="Alamat" placeholder="Alamat Konsumen" required>
  <input type="text" name="No_WA" placeholder="No WA" required>
  <select name="Jenis_Layanan">
    <option value="Cuci Kiloan">Cuci Kiloan</option>
    <option value="Cuci Satuan">Cuci Satuan</option>
  </select>
  <textarea name="Catatan" placeholder="Catatan"></textarea>
  <input type="number" name="Total_Harga" placeholder="Total Harga" required>
  <select name="Metode_Pembayaran">
    <option value="Cash">Cash</option>
    <option value="Transfer">Transfer</option>
  </select>
  <button type="submit">Kirim Kwitansi</button>
</form>

<div id="status"></div>

<div style="margin-top:10px;text-align:center;">
  <button onclick="window.print()">Print Kwitansi</button>
  <button id="waBtn">Share WA</button>
  <button id="copyBtn">Copy Kwitansi</button>
</div>

<div id="kwitansiDisplay"></div>

<script>
const form = document.forms[0];
const display = document.getElementById('kwitansiDisplay');

form.addEventListener('submit', function(){
  // Tampilkan kwitansi sementara di page
  const nama = form.Nama_Konsumen.value || '';
  const alamat = form.Alamat.value || '';
  const noWA = form.No_WA.value || '';
  const jenis = form.Jenis_Layanan.value || '';
  const catatan = form.Catatan.value || '';
  const total = form.Total_Harga.value || '0';
  const metode = form.Metode_Pembayaran.value || '';
  const kwitansiText = `Kwitansi Laundry\nNama: ${nama}\nAlamat: ${alamat}\nWA: ${noWA}\nJenis: ${jenis}\nCatatan: ${catatan}\nTotal: Rp ${total}\nMetode: ${metode}`;
  display.textContent = kwitansiText;
  document.getElementById('status').innerText='Kwitansi tampil, submit akan masuk GSheet';
});

// Share WA
document.getElementById('waBtn').addEventListener('click', function(){
  let noWa = form.No_WA.value || '0';
  if(noWa.startsWith('0')) noWa = '62'+noWa.slice(1);
  const nama = form.Nama_Konsumen.value || '';
  const total = form.Total_Harga.value || '0';
  const msg = `Kwitansi Laundry:\nNama: ${nama}\nTotal: Rp ${total}`;
  const waUrl = `https://wa.me/${noWa}?text=${encodeURIComponent(msg)}`;
  window.open(waUrl,'_blank');
});

// Copy to clipboard
document.getElementById('copyBtn').addEventListener('click', function(){
  const text = display.textContent;
  if(text){
    navigator.clipboard.writeText(text).then(()=>{
      alert('Kwitansi berhasil dicopy ke clipboard!');
    }).catch(err=>{
      alert('Gagal copy kwitansi: '+err);
    });
  } else {
    alert('Tidak ada kwitansi untuk dicopy!');
  }
});
</script>

</body>
</html>